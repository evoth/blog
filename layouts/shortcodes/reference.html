{{ $url := .Get 0 }}
{{ $number := 0 }}
{{ with (.Page.Scratch.Get "references") }}
    {{ $number = len . }}
{{ end }}
{{ .Page.Scratch.Add "references" (slice (dict "Content" .Inner "Url" $url "Page" .Page.RelPermalink "Number" $number)) }}
{{ $link := printf `<a href="%s" data-page="%s" data-number="%d">%s</a>` $url .Page.RelPermalink $number (.Page.RenderString .Inner) }}
{{ partial "tooltip.html" (dict "content" $link "url" $url) }}